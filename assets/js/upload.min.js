var tpiw_file_frame;jQuery(function(t){jQuery(document).on("click","input.select-img",function(e){var i=t(this);e.preventDefault();var a=wp.media.controller.Library.extend({defaults:_.defaults({id:"tpiw-insert-image",title:i.data("uploader_title"),allowLocalEdits:!1,displaySettings:!0,displayUserSettings:!1,multiple:!1,library:wp.media.query({type:"image"})},wp.media.controller.Library.prototype.defaults)});tpiw_file_frame=wp.media.frames.tpiw_file_frame=wp.media({button:{text:jQuery(this).data("uploader_button_text")},state:"tpiw-insert-image",states:[new a],multiple:!1}),tpiw_file_frame.on("select",function(){var t=tpiw_file_frame.state("tpiw-insert-image"),e=t.get("selection"),a=t.display(e.first()).toJSON(),r=e.first().toJSON();a=wp.media.string.props(a,r);var l=i.siblings(".img"),s=a.src;l.val(s);var p=i.siblings(".tpiw-preview-wrap");p.show(),p.find("img").attr("src",s)}),tpiw_file_frame.open()})});